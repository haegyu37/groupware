<!--<!DOCTYPE html>-->
<!--<html lang="ko">-->
<!--<head>-->
<!--    <title>첨부파일 테스트</title>-->
<!--    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>-->
<!--    <meta charset="UTF-8">-->
<!--</head>-->
<!--<body>-->
<!--<h1>첨부파일 테스트 페이지</h1>-->

<!--<form id="uploadForm" enctype="multipart/form-data">-->
<!--    <input type="file" name="attachment" id="fileInput">-->
<!--    <button type="button" id="uploadButton">업로드</button>-->
<!--</form>-->

<!--<div id="result"></div>-->

<!--<div id="downloadDiv" style="display: none;">-->
<!--    <h2>다운로드</h2>-->
<!--    <button type="button" id="downloadButton">다운로드</button>-->
<!--    <div id="downloadResult"></div>-->
<!--</div>-->

<!--<div id="deleteDiv" style="display: none;">-->
<!--    <h2>삭제</h2>-->
<!--    <button type="button" id="deleteButton">삭제</button>-->
<!--    <div id="deleteResult"></div>-->
<!--</div>-->

<!--<script>-->
<!--    let id;-->

<!--    // 첨부파일 업로드-->
<!--    $('#uploadButton').click(function () {-->
<!--        let form = document.getElementById("uploadForm");-->
<!--        let attachment = form.elements["attachment"].files[0]; // 업로드된 파일 가져오기-->

<!--        let formData = new FormData();-->
<!--        formData.append("attachment", attachment); // 파일을 FormData에 추가-->
<!--        formData.append("documentId", 123); // 임의의 documentId 설정 (테스트용)-->
<!--        formData.append("writter", "작성자"); // 작성자 정보 추가-->

<!--        fetch('/attachments/upload', {-->
<!--            method: 'POST',-->
<!--            body: formData-->
<!--        })-->
<!--            .then(response => {-->
<!--                if (response.ok) {-->
<!--                    return response.json(); // JSON 형식의 응답 데이터를 파싱-->
<!--                } else {-->
<!--                    throw new Error('첨부파일 업로드 실패');-->
<!--                }-->
<!--            })-->
<!--            .then(data => {-->
<!--                // 서버로부터 받은 파일 ID를 변수에 할당-->
<!--                id = data.id;-->
<!--                $('#result').text('첨부파일 업로드 성공');-->
<!--                $('#downloadDiv').show(); // 다운로드 섹션 표시-->
<!--                $('#deleteDiv').show(); // 삭제 섹션 표시-->
<!--            })-->
<!--            .catch(error => {-->
<!--                console.error(error);-->
<!--                $('#result').text(error.message); // 오류 메시지 표시-->
<!--            });-->
<!--    });-->


<!--    // 첨부파일 다운로드-->
<!--    $('#downloadButton').click(function () {-->
<!--        if (id) {-->
<!--            window.location.href = '/attachments/download/' + id;-->
<!--        } else {-->
<!--            $('#downloadResult').text('다운로드할 파일이 없습니다.');-->
<!--        }-->
<!--    });-->

<!--    // 첨부파일 삭제-->
<!--    $('#deleteButton').click(function () {-->
<!--        fetch('/attachments/delete/' + id, {-->
<!--            method: 'DELETE'-->
<!--        })-->
<!--            .then(response => {-->
<!--                if (response.ok) {-->
<!--                    $('#result').text('첨부파일 삭제 성공');-->
<!--                    $('#downloadDiv').hide(); // 다운로드 섹션 숨기기-->
<!--                    $('#deleteDiv').hide(); // 삭제 섹션 숨기기-->
<!--                } else {-->
<!--                    throw new Error('첨부파일 삭제 실패');-->
<!--                }-->
<!--            })-->
<!--            .catch(error => {-->
<!--                console.error(error);-->
<!--                $('#result').text('첨부파일 삭제 실패');-->
<!--            });-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="ko">
<head>
    <title>첨부파일 테스트</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <meta charset="UTF-8">
</head>
<body>
<h1>첨부파일 테스트 페이지</h1>
<form id="uploadForm" enctype="multipart/form-data">
    <input type="file" name="attachment" id="fileInput">
    <input type="hidden" name="documentId" value="123">
    <input type="hidden" name="writter" value="작성자">
    <button type="button" id="uploadButton">업로드</button>
</form>
<div id="result"></div>
<div id="downloadDiv" style="display: none;">
    <h2>다운로드</h2>
    <button type="button" id="downloadButton">다운로드</button>
    <div id="downloadResult"></div>
</div>
<div id="deleteDiv" style="display: none;">
    <h2>삭제</h2>
    <button type="button" id="deleteButton">삭제</button>
    <div id="deleteResult"></div>
</div>
<script>
    let id;

    // 첨부파일 업로드
    $('#uploadButton').click(function () {
        let form = document.getElementById("uploadForm");
        let attachment = form.elements["attachment"].files[0]; // 업로드된 파일 가져오기

        let formData = new FormData();
        formData.append("attachment", attachment); // 파일을 FormData에 추가
        formData.append("documentId", form.elements["documentId"].value); // documentId 값을 가져와서 FormData에 추가
        formData.append("writter", form.elements["writter"].value); // writter 값을 가져와서 FormData에 추가

        fetch('/attachments/upload', {
            method: 'POST',
            body: formData
        })
            .then(response => {
                if (response.ok) {
                    return response.json(); // JSON 형식의 응답 데이터를 파싱
                } else {
                    throw new Error('첨부파일 업로드 실패');
                }
            })
            .then(data => {
                // 서버로부터 받은 파일 ID를 변수에 할당
                id = data.id;
                $('#result').text('첨부파일 업로드 성공');
                $('#downloadDiv').show(); // 다운로드 섹션 표시
                $('#deleteDiv').show(); // 삭제 섹션 표시
            })
            .catch(error => {
                console.error(error);
                $('#result').text(error.message); // 오류 메시지 표시
            });
    });

    // 첨부파일 다운로드
    $('#downloadButton').click(function () {
        if (id) {
            window.location.href = '/attachments/download/' + id;
        } else {
            $('#downloadResult').text('다운로드할 파일이 없습니다.');
        }
    });

    // 첨부파일 삭제
    $('#deleteButton').click(function () {
        fetch('/attachments/delete/' + id, {
            method: 'DELETE'
        })
            .then(response => {
                if (response.ok) {
                    $('#result').text('첨부파일 삭제 성공');
                    $('#downloadDiv').hide(); // 다운로드 섹션 숨기기
                    $('#deleteDiv').hide(); // 삭제 섹션 숨기기
                } else {
                    throw new Error('첨부파일 삭제 실패');
                }
            })
            .catch(error => {
                console.error(error);
                $('#result').text('첨부파일 삭제 실패');
            });
    });
</script>
</body>
</html>